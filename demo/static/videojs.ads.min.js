/*! videojs-contrib-ads - v4.1.1 - 2016-11-06
* Copyright (c) 2016 ; Licensed  */
!function(a){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define([],a);else{var b;b="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,b.videojsContribAds=a()}}(function(){return function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){"use strict";var d=function(a){a.ads.cancelPlayTimeout||(videojs.browser.IS_IOS&&!function(){var b=a.currentWidth?a.currentWidth():a.width(),c=a.currentHeight?a.currentHeight():a.height(),d=document.createElement("div");d.style.width=b+"px",d.style.height=c+"px",d.style.background="black",a.el_.parentNode.insertBefore(d,a.el_),a.el_.style.display="none",a.one(["adplaying","adtimeout","adserror","adscanceled","adskip","playing"],function(){a.el_.style.display="block",d.remove()})}(),a.ads.cancelPlayTimeout=window.setTimeout(function(){a.ads.cancelPlayTimeout=null,a.paused()||a.pause(),a.ads.cancelledPlay=!0},1))};b.exports=d},{}],2:[function(a,b,c){"use strict";var d=function(a){a.ads.contentSrc=a.currentSrc();var b=function(){if("ad-playback"!==a.ads.state){var b=a.currentSrc();b!==a.ads.contentSrc&&(a.trigger({type:"contentupdate",oldValue:a.ads.contentSrc,newValue:b}),a.ads.contentSrc=b)}};a.on("loadstart",b),window.setTimeout(b,1)};b.exports=d},{}],3:[function(a,b,c){(function(a){"use strict";function c(a){return a&&a.__esModule?a:{"default":a}}var d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},e="undefined"!=typeof window?window.videojs:"undefined"!=typeof a?a.videojs:null,f=c(e),g=function(a,b){return b?encodeURIComponent(a):a},h=function(a,b,c){if(a&&a[c])for(var d=a[c],e=Object.keys(d),f=0;f<e.length;f++){var g="{mediainfo."+c+"."+e[f]+"}";b[g]=d[e[f]]}},i=function(a,b,c){void 0===b&&(b=!1);var e={};void 0!==c&&(e=c),e["{player.id}"]=this.options_["data-player"],e["{mediainfo.id}"]=this.mediainfo?this.mediainfo.id:"",e["{mediainfo.name}"]=this.mediainfo?this.mediainfo.name:"",e["{mediainfo.description}"]=this.mediainfo?this.mediainfo.description:"",e["{mediainfo.tags}"]=this.mediainfo?this.mediainfo.tags:"",e["{mediainfo.reference_id}"]=this.mediainfo?this.mediainfo.reference_id:"",e["{mediainfo.duration}"]=this.mediainfo?this.mediainfo.duration:"",e["{mediainfo.ad_keys}"]=this.mediainfo?this.mediainfo.ad_keys:"",e["{player.duration}"]=this.duration(),e["{timestamp}"]=(new Date).getTime(),e["{document.referrer}"]=document.referrer,e["{window.location.href}"]=window.location.href,e["{random}"]=Math.floor(1e12*Math.random()),h(this.mediainfo,e,"custom_fields"),h(this.mediainfo,e,"customFields");for(var i in e)a=a.split(i).join(g(e[i],b));return a=a.replace(/{pageVariable\.([^}]+)}/g,function(a,c){for(var e=void 0,h=window,i=c.split("."),j=0;j<i.length;j++)j===i.length-1?e=h[i[j]]:h=h[i[j]];var k="undefined"==typeof e?"undefined":d(e);return null===e?"null":void 0===e?(f["default"].log.warn('Page variable "'+c+'" not found'),""):"string"!==k&&"number"!==k&&"boolean"!==k?(f["default"].log.warn('Page variable "'+c+'" is not a supported type'),""):g(String(e),b)})};b.exports=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],4:[function(a,b,c){(function(a){"use strict";function c(a){return a&&a.__esModule?a:{"default":a}}var d="undefined"!=typeof window?window.videojs:"undefined"!=typeof a?a.videojs:null,e=(c(d),function(a,b,c){c.isImmediatePropagationStopped=function(){return!0},c.cancelBubble=!0,c.isPropagationStopped=function(){return!0},a.trigger({type:b+c.type,state:a.ads.state,originalEvent:c})}),f=function(a){if("playing"===a.type&&"preroll?"===this.ads.state)e(this,"ad",a);else if("playing"!==a.type||"ad-playback"!==this.ads.state||this.ads.videoElementRecycled())if("playing"===a.type&&"ads-ready?"===this.ads.state)e(this,"ad",a);else{if("playing"===a.type&&"ad-playback"===this.ads.state&&this.ads.videoElementRecycled())return void e(this,"adcontent",a);if("ad-playback"===this.ads.state)(this.ads.videoElementRecycled()||this.ads.stitchedAds())&&e(this,"ad",a);else if("content-playback"===this.ads.state&&"ended"===a.type)e(this,"content",a);else if("content-resuming"===this.ads.state){if(this.ads.snapshot&&this.currentSrc()!==this.ads.snapshot.currentSrc){if("loadstart"===a.type)return;return e(this,"content",a)}if(this.ads.snapshot&&this.ads.snapshot.ended){if("pause"===a.type||"ended"===a.type)return;return e(this,"content",a)}"playing"!==a.type&&e(this,"content",a)}}else e(this,"ad",a)};b.exports=f}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],5:[function(a,b,c){(function(a){"use strict";function c(a){return a&&a.__esModule?a:{"default":a}}var d="undefined"!=typeof window?window.videojs:"undefined"!=typeof a?a.videojs:null,e=c(d),f={};f.getPlayerSnapshot=function(a){var b=void 0;b=e["default"].browser.IS_IOS&&a.ads.isLive(a)&&a.seekable().length>0?a.currentTime()-a.seekable().end(0):a.currentTime();var c=a.$(".vjs-tech"),d=a.remoteTextTracks?a.remoteTextTracks():[],f=[],g={ended:a.ended(),currentSrc:a.currentSrc(),src:a.src(),currentTime:b,type:a.currentType()};c&&(g.nativePoster=c.poster,g.style=c.getAttribute("style"));for(var h=d.length;h>0;h--){var i=d[h];f.push({track:i,mode:i.mode}),i.mode="disabled"}return g.suppressedTracks=f,g},f.restorePlayerSnapshot=function(a,b){if(a.ads.disableNextSnapshotRestore===!0)return void(a.ads.disableNextSnapshotRestore=!1);var c=a.$(".vjs-tech"),d=20,f=b.suppressedTracks,g=void 0,h=function(){for(var a=f.length;a>0;a--)g=f[a],g.track.mode=g.mode},i=function(){var c=void 0;e["default"].browser.IS_IOS&&a.ads.isLive(a)?b.currentTime<0&&(c=a.seekable().length>0?a.seekable().end(0)+b.currentTime:a.currentTime(),a.currentTime(c)):a.currentTime(b.ended?a.duration():b.currentTime),b.ended||a.play()},j=function k(){if(a.off("contentcanplay",k),a.ads.tryToResumeTimeout_&&(a.clearTimeout(a.ads.tryToResumeTimeout_),a.ads.tryToResumeTimeout_=null),c=a.el().querySelector(".vjs-tech"),c.readyState>1)return i();if(void 0===c.seekable)return i();if(c.seekable.length>0)return i();if(d--)window.setTimeout(k,50);else try{i()}catch(b){e["default"].log.warn("Failed to resume the content after an advertisement",b)}};b.nativePoster&&(c.poster=b.nativePoster),"style"in b&&c.setAttribute("style",b.style||""),a.ads.videoElementRecycled()?(a.one("contentloadedmetadata",h),a.src({src:b.currentSrc,type:b.type}),a.load(),a.one("contentcanplay",j),a.ads.tryToResumeTimeout_=a.setTimeout(j,2e3)):a.ended()&&b.ended||(h(),a.play())},b.exports=f}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],6:[function(a,b,c){(function(b){"use strict";function c(a){return a&&a.__esModule?a:{"default":a}}var d="undefined"!=typeof window?window.videojs:"undefined"!=typeof b?b.videojs:null,e=c(d),f=a("./redispatch.js"),g=c(f),h=a("./snapshot.js"),i=c(h),j=a("./contentupdate.js"),k=c(j),l=a("./cancelContentPlay.js"),m=c(l),n=a("./macros.js"),o=c(n),p=e["default"].getComponent("Html5").Events,q=function(a){var b=a.$(".vjs-tech");b&&b.removeAttribute("poster")},r={timeout:5e3,prerollTimeout:100,postrollTimeout:100,debug:!1,stitchedAds:!1},s=function(a){var b=this,c=e["default"].mergeOptions(r,a),d=p.concat(["firstplay","loadedalldata","playing"]);b.on(d,g["default"]),b.on(["pause","ended"],function(){"content-resuming"===b.ads.state&&b.ads.snapshot&&b.ads.snapshot.ended&&b.addClass("vjs-has-started")}),b.on(["addurationchange","adcanplay"],function(){b.currentSrc()!==b.ads.snapshot.currentSrc&&b.play()}),b.on("nopreroll",function(){b.ads.nopreroll_=!0}),b.on("nopostroll",function(){b.ads.nopostroll_=!0}),b.on(["ads-ad-started","playing"],function(){b.removeClass("vjs-ad-loading")}),b.ads={state:"content-set",disableNextSnapshotRestore:!1,VERSION:"4.1.1",startLinearAdMode:function(){("preroll?"===b.ads.state||"content-playback"===b.ads.state||"postroll?"===b.ads.state)&&b.trigger("adstart")},endLinearAdMode:function(){"ad-playback"===b.ads.state&&(b.trigger("adend"),b.removeClass("vjs-ad-loading"))},skipLinearAdMode:function(){"ad-playback"!==b.ads.state&&b.trigger("adskip")},stitchedAds:function(a){return void 0!==a&&(this._stitchedAds=!!a),this._stitchedAds},videoElementRecycled:function(){var a=void 0,c=void 0;if(!this.snapshot)throw new Error("You cannot use videoElementRecycled while there is no snapshot.");return a=b.src()!==this.snapshot.src,c=b.currentSrc()!==this.snapshot.currentSrc,a||c},isLive:function(a){return a.duration()===1/0?!0:"8"===e["default"].browser.IOS_VERSION&&0===a.duration()?!0:!1},shouldPlayContentBehindAd:function(a){return!e["default"].browser.IS_IOS&&!e["default"].browser.IS_ANDROID&&a.duration()===1/0}},b.ads.stitchedAds(c.stitchedAds),b.ads.adMacroReplacement=o["default"].bind(b),k["default"](b);var f={"content-set":{events:{adscanceled:function(){this.state="content-playback"},adsready:function(){this.state="ads-ready"},play:function(){this.state="ads-ready?",m["default"](b),q(b)},adserror:function(){this.state="content-playback"},adskip:function(){this.state="content-playback"}}},"ads-ready":{events:{play:function(){this.state="preroll?",m["default"](b)},adskip:function(){this.state="content-playback"},adserror:function(){this.state="content-playback"}}},"preroll?":{enter:function(){b.ads.nopreroll_?(b.trigger("readyforpreroll"),window.setTimeout(function(){b.trigger("nopreroll")},1)):(b.addClass("vjs-ad-loading"),b.ads.adTimeoutTimeout=window.setTimeout(function(){b.trigger("adtimeout")},c.prerollTimeout),b.trigger("readyforpreroll"))},leave:function(){window.clearTimeout(b.ads.adTimeoutTimeout)},events:{play:function(){m["default"](b)},adstart:function(){this.state="ad-playback"},adskip:function(){this.state="content-playback"},adtimeout:function(){this.state="content-playback"},adserror:function(){this.state="content-playback"},nopreroll:function(){this.state="content-playback"}}},"ads-ready?":{enter:function(){b.addClass("vjs-ad-loading"),b.ads.adTimeoutTimeout=window.setTimeout(function(){b.trigger("adtimeout")},c.timeout)},leave:function(){window.clearTimeout(b.ads.adTimeoutTimeout),b.removeClass("vjs-ad-loading")},events:{play:function(){m["default"](b)},adscanceled:function(){this.state="content-playback"},adsready:function(){this.state="preroll?"},adskip:function(){this.state="content-playback"},adtimeout:function(){this.state="content-playback"},adserror:function(){this.state="content-playback"}}},"ad-playback":{enter:function(){b.ads.shouldPlayContentBehindAd(b)||(this.snapshot=i["default"].getPlayerSnapshot(b)),b.ads.shouldPlayContentBehindAd(b)&&(this.preAdVolume_=b.volume(),b.volume(0)),b.addClass("vjs-ad-playing"),q(b),b.ads.cancelPlayTimeout&&window.setTimeout(function(){window.clearTimeout(b.ads.cancelPlayTimeout),b.ads.cancelPlayTimeout=null},1)},leave:function(){b.removeClass("vjs-ad-playing"),b.ads.shouldPlayContentBehindAd(b)||i["default"].restorePlayerSnapshot(b,this.snapshot),b.ads.shouldPlayContentBehindAd(b)&&b.volume(this.preAdVolume_)},events:{adend:function(){this.state="content-resuming"},adserror:function(){this.state="content-resuming",b.trigger("adend")}}},"content-resuming":{enter:function(){this.snapshot&&this.snapshot.ended&&(window.clearTimeout(b.ads._fireEndedTimeout),b.ads._fireEndedTimeout=window.setTimeout(function(){b.trigger("ended")},1e3))},leave:function(){window.clearTimeout(b.ads._fireEndedTimeout)},events:{contentupdate:function(){this.state="content-set"},contentresumed:function(){this.state="content-playback"},playing:function(){this.state="content-playback"},ended:function(){this.state="content-playback"}}},"postroll?":{enter:function(){this.snapshot=i["default"].getPlayerSnapshot(b),b.ads.nopostroll_?window.setTimeout(function(){b.ads.state="content-resuming",b.trigger("ended")},1):(b.addClass("vjs-ad-loading"),b.ads.adTimeoutTimeout=window.setTimeout(function(){b.trigger("adtimeout")},c.postrollTimeout))},leave:function(){window.clearTimeout(b.ads.adTimeoutTimeout),b.removeClass("vjs-ad-loading")},events:{adstart:function(){this.state="ad-playback"},adskip:function(){this.state="content-resuming",window.setTimeout(function(){b.trigger("ended")},1)},adtimeout:function(){this.state="content-resuming",window.setTimeout(function(){b.trigger("ended")},1)},adserror:function(){this.state="content-resuming",window.setTimeout(function(){b.trigger("ended")},1)},contentupdate:function(){this.state="ads-ready?"}}},"content-playback":{enter:function(){b.ads.cancelPlayTimeout&&(window.clearTimeout(b.ads.cancelPlayTimeout),b.ads.cancelPlayTimeout=null),b.trigger({type:"contentplayback",triggerevent:b.ads.triggerevent}),b.ads.cancelledPlay&&(b.ads.cancelledPlay=!1,b.paused()&&b.play())},events:{adsready:function(){b.trigger("readyforpreroll")},adstart:function(){this.state="ad-playback"},contentupdate:function(){b.paused()?this.state="content-set":this.state="ads-ready?",this.snapshot&&this.snapshot.ended&&(this.snapshot=null)},contentended:function(){b.ads.snapshot&&b.ads.snapshot.ended||(this.state="postroll?")},play:function(){b.currentSrc()!==b.ads.contentSrc&&m["default"](b)}}}},h=function(a){var d=b.ads.state,g=f[d].events;if(g){var h=g[a.type];h&&h.apply(b.ads)}if(d!==b.ads.state){var i=d,j=b.ads.state;b.ads.triggerevent=a.type,f[i].leave&&f[i].leave.apply(b.ads),f[j].enter&&f[j].enter.apply(b.ads),c.debug&&e["default"].log("ads",b.ads.triggerevent+" triggered: "+i+" -> "+j)}};b.on(p.concat(["adtimeout","contentupdate","contentplaying","contentended","contentresumed","adstart","adend","adskip","adsready","adserror","adscanceled","nopreroll"]),h),b.paused()||h({type:"play"})};e["default"].plugin("ads",s)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./cancelContentPlay.js":1,"./contentupdate.js":2,"./macros.js":3,"./redispatch.js":4,"./snapshot.js":5}]},{},[6])(6)});