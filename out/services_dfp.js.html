<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: services/dfp.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: services/dfp.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * @file Defines the doubleClick service.
 * @author Peter Goldsborough &lt;peter@goldsborough.me>
 * @license MIT
 */

// eslint-disable-next-line no-use-before-define
let googletag = googletag || {};
googletag.cmd = googletag.cmd || [];

let angularDfp = (function(module) {
  "use strict";

  /**
   * The URL to the GPT library we want to load asynchronously.
   */
  module.constant(
    'GPT_LIBRARY_URL',
    '//www.googletagservices.com/tag/js/gpt.js'
  );

  /**
   * The provider for the doubleClick service.
   *
   * The doubleClick service is responsible for main initial configuration
   * tasks, injecting the GPT library asynchronously and providing the `then`
   * proxy to `googletag.cmd.push`.
   *
   * @param {object} scriptInjector The script injection service.
   * @param {string} GPT_LIBRARY_URL The URL of the GPT library to inject.
   */
  function doubleClickProvider(scriptInjector, GPT_LIBRARY_URL) {
    /**
     * The doubleClickProvider function.
     * @type {function}
     * @constant
     */
    const self = this;

    /**
     * Whether to enable Single Request Architecture (SRA) mode.
     * @type {Boolean}
     */
    self.enableSingleRequestArchitecture = true;

    /**
     * Whether to enable video ads.
     * @type {Boolean}
     */
    self.enableVideoAds = true;

    /**
     * Whether to collapse empty divs for which ad calls fail.
     * @type {Boolean}
     */
    self.collapseEmptyDivs = true;

    /**
     * Whether to enable the initial load of ads.
     *
     * This is necessary if you want to be able to
     * manually refresh ads with refresh().
     *
     * @type {Boolean}
     */
    self.disableInitialLoad = true;

    // Whether or not we have loaded the GPT library yet.
    let loaded = false;

    /**
     * The configuration function called to initialize the doubleClick service.
     */
    function dfp() {
      // Push the initial configuration into the command queue.
      googletag.cmd.push(function() {
        if (self.enableSingleRequestArchitecture) {
          googletag.pubads().enableSingleRequest();
        }

        if (self.enableVideoAds) {
          googletag.pubads().enableVideoAds();
        }

        if (self.collapseEmptyDivs) {
          googletag.pubads().collapseEmptyDivs();
        }

        if (self.disableInitialLoad) {
          googletag.pubads().disableInitialLoad();
        }

        googletag.enableServices();
      });

      scriptInjector(GPT_LIBRARY_URL).then(function() {
        loaded = true;
      });
    }

    /**
     * Tests if the GPT library has been injected yet.
     * @return {Boolean} [description]
     */
    dfp.hasLoaded = function() {
      return loaded;
    };

    /**
     * Pushes a taks into GPT's asynchronous task queue.
     * @param  {function} task The task function to execute in the queue.
     */
    dfp.then = function(task) {
      googletag.cmd.push(task);
    };

    // The factory function
    this.$get = function() {
      return dfp;
    };
  }

  module.provider('doubleClick', [
    'scriptInjector', 'GPT_LIBRARY_URL', doubleClickProvider
  ]);

// eslint-disable-next-line
})(angularDfp || angular.module('angular-dfp'));
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.2</a> on Sat Oct 08 2016 14:27:04 GMT+0100 (BST)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
